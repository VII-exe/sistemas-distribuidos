# Sistema de Mensagens DistribuÃ­das

## DescriÃ§Ã£o

Sistema distribuÃ­do de publicaÃ§Ã£o e leitura de mensagens entre mÃºltiplos nÃ³s, implementando consistÃªncia eventual e autenticaÃ§Ã£o bÃ¡sica. Desenvolvido para a disciplina de Sistemas DistribuÃ­dos do IFBA - Campus Santo AntÃ´nio de Jesus.

## Arquitetura

- **3 nÃ³s distribuÃ­dos** (Node1, Node2, Node3)
- **ComunicaÃ§Ã£o TCP** entre nÃ³s (portas 8001, 8002, 8003)
- **Interface Web HTTP** (portas 9001, 9002, 9003)
- **Cliente terminal** para interaÃ§Ã£o avanÃ§ada
- **ReplicaÃ§Ã£o assÃ­ncrona** de mensagens
- **ConsistÃªncia eventual** com sincronizaÃ§Ã£o automÃ¡tica

## PrÃ©-requisitos

- Python 3.8+
- Sistema operacional: Windows
- Portas 8001-8003 para login e 9001-9003 para interface web disponÃ­veis

## Estrutura do Projeto

```bash
sistema-distribuido-de-mensageria/
â”œâ”€â”€ client/
â”‚   â”œâ”€â”€ client.py              # Cliente terminal interativo
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ auth.py                # Sistema de autenticaÃ§Ã£o
â”‚   â”œâ”€â”€ message.py             # Estrutura das mensagens
â”‚   â”œâ”€â”€ node.py                # LÃ³gica principal dos nÃ³s
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ index.html             # Interface web
â”‚   â”œâ”€â”€ app.js                 # JavaScript do frontend
â”‚   â””â”€â”€ styles.css             # Estilos CSS
â”œâ”€â”€ logs/                      # Logs do sistema (criado automaticamente)
â”œâ”€â”€ nodes/
â”‚   â”œâ”€â”€ node1/run.py          # Executor do Node1
â”‚   â”œâ”€â”€ node2/run.py          # Executor do Node2
â”‚   â””â”€â”€ node3/run.py          # Executor do Node3
â”œâ”€â”€ iniciar_programa.py        # Script principal de inicializaÃ§Ã£o
â””â”€â”€ README.md                # Este arquivo
```

## Como Executar

### MÃ©todo 1: ExecuÃ§Ã£o AutomÃ¡tica (Recomendado)

1. **Clone o repositÃ³rio:**

```bash
git clone <URL_DO_REPOSITORIO>
cd sistema-distribuido-de-mensageria
```

2. **Execute o script principal:**

```bash
python iniciar_programa.py
```

3. **O sistema irÃ¡:**
   - Iniciar os 3 nÃ³s automaticamente
   - Abrir o cliente terminal em nova janela
   - Disponibilizar interfaces web em:
     - <http://localhost:9001> (Node1)
     - <http://localhost:9002> (Node2)
     - <http://localhost:9003> (Node3)

### MÃ©todo 2: ExecuÃ§Ã£o Manual

1. **Terminal 1 - Node1:**

```bash
python nodes/node1/run.py
```

2. **Terminal 2 - Node2:**

```bash
python nodes/node2/run.py
```

3. **Terminal 3 - Node3:**

```bash
python nodes/node3/run.py
```

4. **Terminal 4 - Cliente:**

```bash
python client/client.py
```

## ğŸ‘¤ UsuÃ¡rios DisponÃ­veis

| UsuÃ¡rio | Senha | DescriÃ§Ã£o |
|---------|-------|-----------|
| admin | admin123 | Administrador |
| user1 | password1 | UsuÃ¡rio 1 |
| user2 | password2 | UsuÃ¡rio 2 |
| test | test | UsuÃ¡rio de teste |

## ğŸ® Como Usar

### Interface Terminal

1. **Login em um nÃ³:**

```python
login admin admin123 8001
```

2. **Enviar mensagem pÃºblica:**

```python
post OlÃ¡, pessoal!
```

3. **Enviar mensagem privada:**

```python
postpv Mensagem confidencial
```

4. **Ler mensagens:**

```python
read                    # Ler mensagens do nÃ³ atual
read 8002              # Ler mensagens do Node2
readpub 8003           # Ler apenas mensagens pÃºblicas do Node3
```

5. **Gerenciar mÃºltiplos usuÃ¡rios:**

```python
login user1 password1 8002    # Login em outro nÃ³
switch                        # Alternar entre usuÃ¡rios
```

6. **Simular falhas:**

```pyhon
simulate                # Simular falha do nÃ³ atual
simulate                # Reconectar (recupera mensagens perdidas)
```

7. **Comandos Ãºteis:**

```python
status                  # Ver status de todos os nÃ³s
help                    # Ver todos os comandos
quit                    # Sair
```

### Interface Web

1. **Acesse qualquer interface:**
   - <http://localhost:9001>
   - <http://localhost:9002>
   - <http://localhost:9003>

2. **FaÃ§a login ou visualize mensagens pÃºblicas**

3. **Envie mensagens pÃºblicas ou privadas**

4. **Simule falhas atravÃ©s do botÃ£o "Simular Falha"**

## CenÃ¡rios de Teste

### Teste 1: ReplicaÃ§Ã£o BÃ¡sica

1. Login user1 no Node1 e user2 no Node2
2. user1 envia: "Mensagem pÃºblica"
3. Verificar se aparece no chat do user2

### Teste 2: Mensagens Privadas

1. Login em dois nÃ³s diferentes
2. Enviar mensagem privada
3. Verificar visibilidade apenas para usuÃ¡rios logados

### Teste 3: SimulaÃ§Ã£o de Falha

1. Login em Node1 e Node2
2. Simular falha no Node2
3. Enviar mensagens do Node1
4. Reconectar Node2 e verificar sincronizaÃ§Ã£o

### Teste 4: ConsistÃªncia Eventual

1. Simular falha em 2 nÃ³s
2. Deixar 1 nÃ³ ativo e enviar vÃ¡rias mensagens
3. Reconectar nÃ³s offline
4. Verificar se todas as mensagens foram sincronizadas

### Teste 5: Login Duplicado

1. Tentar fazer login com mesmo usuÃ¡rio em mÃºltiplos nÃ³s
2. Sistema deve impedir login duplicado

## Logs e Monitoramento

### Logs do Sistema

Os logs sÃ£o salvos automaticamente em:

- `logs/Node1.log` - Logs do Node1
- `logs/Node2.log` - Logs do Node2  
- `logs/Node3.log` - Logs do Node3

### InformaÃ§Ãµes nos Logs

- Tentativas de login
- Envio e recebimento de mensagens
- OperaÃ§Ãµes de sincronizaÃ§Ã£o
- SimulaÃ§Ãµes de falha
- ReconexÃµes e recuperaÃ§Ã£o

## SoluÃ§Ã£o de Problemas

### Erro "Porta em uso"

```bash
# Verificar processos usando as portas
netstat -an | grep :8001
netstat -an | grep :9001

# Matar processos se necessÃ¡rio (Windows)
taskkill /f /pid <PID>
```

### Cliente nÃ£o conecta

1. Verificar se os nÃ³s estÃ£o rodando
2. Verificar se as portas estÃ£o disponÃ­veis
3. Tentar reiniciar o sistema

### Interface web nÃ£o carrega

1. Verificar se a pasta `frontend/` existe
2. Verificar permissÃµes de arquivo
3. Tentar acessar diretamente: <http://localhost:9001>

### Problemas de sincronizaÃ§Ã£o

1. Verificar logs em `logs/`
2. Reiniciar todos os nÃ³s
3. Testar com apenas 2 nÃ³s primeiro

## ğŸ—ï¸ Tecnologias Utilizadas

- **Python 3.8+** - Linguagem principal
- **Socket TCP** - ComunicaÃ§Ã£o entre nÃ³s
- **HTTP Server** - Interface web
- **Bootstrap 5** - Frontend responsivo
- **JSON** - SerializaÃ§Ã£o de dados
- **MD5** - Hash de senhas (para simplicidade)
- **Threading** - ConcorrÃªncia

## Funcionalidades Implementadas

### Requisitos ObrigatÃ³rios

- [x] MÃ­nimo 3 nÃ³s distribuÃ­dos
- [x] CÃ³pia local do mural em cada nÃ³
- [x] ComunicaÃ§Ã£o via sockets TCP
- [x] ReplicaÃ§Ã£o assÃ­ncrona
- [x] ConsistÃªncia eventual
- [x] AutenticaÃ§Ã£o bÃ¡sica
- [x] Leitura pÃºblica sem autenticaÃ§Ã£o
- [x] SimulaÃ§Ã£o de falhas
- [x] ReconciliaÃ§Ã£o apÃ³s reconexÃ£o

### Funcionalidades Extras

- [x] Interface web responsiva
- [x] Cliente terminal avanÃ§ado
- [x] MÃºltiplos usuÃ¡rios simultÃ¢neos
- [x] Mensagens pÃºblicas e privadas
- [x] Logs detalhados para auditoria
- [x] Sistema de status em tempo real
- [x] PrevenÃ§Ã£o de login duplicado

## ğŸ‘¥ Autores

- **Aluno:** Vinicius X. e Kleberson J.
- **Disciplina:** Sistemas DistribuÃ­dos
- **Professor:** Felipe Silva
- **InstituiÃ§Ã£o:** IFBA - Campus Santo AntÃ´nio de Jesus
- **Curso:** Superior de Tecnologia em AnÃ¡lise e Desenvolvimento de Sistemas - 5Âº Semestre
